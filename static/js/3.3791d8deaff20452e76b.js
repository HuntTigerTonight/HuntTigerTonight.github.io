webpackJsonp([3],{FuKY:function(t,e){},mvHQ:function(t,e,a){t.exports={default:a("qkKv"),__esModule:!0}},qkKv:function(t,e,a){var i=a("FeBl"),n=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return n.stringify.apply(n,arguments)}},udZr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),n=a.n(i),l=a("woOf"),o=a.n(l),s=a("Dd8w"),r=a.n(s),c=a("Rly4"),u=a("NYxO"),d={data:function(){return{name:null,account:{},pageSize:20,currentPage:1,dialogVisible:!1,dialogAdd:!1,dialogEdit:!1,roles:{},height:document.documentElement.clientHeight-242,act:null,ids:[],confirmPassword:null,formLabelWidth:"150px",Info:{hospitalStation:{departmentId:null,hospitalId:null,hospitalName:null,departmentName:null,name:null},newPassword:null,username:null,type:"hospital-station",state:"enabled",id:null},isShow:null,rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],"hospitalStation[name]":[{required:!0,message:"请输入姓名",trigger:"blur"}],"hospitalStation[hospitalId]":[{type:"number",required:!0,message:"请选择所属医院",trigger:"blur"}]}}},computed:r()({},Object(u.c)(["hospitalList","hospitalObj","departmentList","isSuperAdmin","hospitalIdBelongsAccount"])),methods:{getLists:function(){var t=this;Object(c.a)("get","account/accounts",{limit:this.pageSize,page:this.currentPage,filters:[{property:"username",value:this.name,operation:"ALIKE"}],type:"hospital"}).then(function(e){t.account=e})},sizeChange:function(t){this.pageSize=t,this.getLists()},currentChange:function(t){if(this.currentPage==t)return!1;this.currentPage=t,this.getLists()},conditionalQuery:function(){this.getLists()},add:function(){o()(this.$data.Info,this.$options.data().Info),this.Info.hospitalStation.hospitalId=this.hospitalIdBelongsAccount,this.dialogAdd=!0},addSave:function(){var t=this;this.$refs.ruleFormAdd.validate(function(e){if(!e)return!1;Object(c.a)("post","account",t.Info).then(function(e){t.dialogAdd=!1,t.$message({showClose:!0,message:"新增账号成功",type:"success"}),t.getLists()})})},type:function(t,e,a){return"cpc-employee"==t.type?"个人":"m-station"==t.type?"移动工作站":"hospital-station"==t.type?"医院工作站":void 0},hospital:function(t){return this.hospitalObj[t.hospitalId]},state:function(t){return"enabled"==t.row.state?"启用":"禁用"},resetPass:function(t){var e=this;Object(c.a)("put","account/resetPassword",{username:t.row.username}).then(function(t){e.$message({showClose:!0,message:"密码重置成功",type:"success"})})},edit:function(t){this.Info=JSON.parse(n()(t.row)),null==this.Info.hospitalStation&&(this.Info.hospitalStation={departmentId:null,hospitalId:null,hospitalName:null,departmentName:null,name:null}),this.dialogEdit=!0},editSave:function(){var t=this;this.Info.hospitalId=this.Info.hospitalStation.hospitalId,this.Info.hospitalStation.departmentName=null,this.$refs.ruleFormEdit.validate(function(e){if(!e)return!1;Object(c.a)("PUT","account/"+t.Info.id,t.Info).then(function(e){t.dialogEdit=!1,t.$message({showClose:!0,message:"编辑账号成功",type:"success"}),t.getLists()})})},delete:function(t){var e=this;Object(c.a)("DELETE","account/"+t).then(function(t){e.$message({type:"success",message:"删除成功!"}),e.getLists()})},deleteRow:function(t){var e=this;this.$confirm("此操作将永久删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.delete(t.row.id)}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},findAccountRoles:function(t){var e=this;this.roles={},this.act=t.row.username,Object(c.a)("get","account/authorization",{act:t.row.username}).then(function(t){e.dialogVisible=!0,e.roles=t.data,e.ids=e.roles.accountRole})},EditRole:function(){var t=this,e=this.ids.join(",");Object(c.a)("put","account/authorization",{act:this.act,rids:e}).then(function(e){t.dialogVisible=!1,t.$message({showClose:!0,message:"角色分配成功",type:"success"})})}},created:function(){this.getLists()}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"search_box"},[a("table",[a("tr",[a("td",[a("label",[t._v("账号：")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入账号",size:"small","suffix-icon":"el-icon-edit-outline",clearable:""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),t._v(" "),a("td",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return e.preventDefault(),t.conditionalQuery(e)}}},[a("span",{staticClass:"el-icon-search"}),t._v(" "),a("span",[t._v("查询")])]),t._v(" "),t.common.permissions("POST@/account")?a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(e){return e.preventDefault(),t.add(e)}}},[a("span",{staticClass:"el-icon-plus"}),t._v(" "),a("span",[t._v("新增")])]):t._e()],1)])])]),t._v(" "),a("div",{staticStyle:{margin:"0 auto"}},[a("div",{staticClass:"table_data"},[a("el-table",{attrs:{stripe:!0,data:t.account.data,border:"","max-height":t.height}},[a("el-table-column",{attrs:{type:"index",label:"序号","header-align":"center",align:"center",width:"65"}}),t._v(" "),a("el-table-column",{attrs:{prop:"username",label:"账号","header-align":"center",align:"center","min-width":"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"hospitalStation.name",label:"姓名","header-align":"center",align:"center","min-width":"150"}}),t._v(" "),t.isSuperAdmin||"666666"==t.hospitalIdBelongsAccount?a("el-table-column",{attrs:{formatter:t.hospital,label:"所属医院","header-align":"center",align:"center","min-width":"200"}}):t._e(),t._v(" "),a("el-table-column",{attrs:{prop:"hospitalStation.departmentName",label:"科室","header-align":"center",align:"center","min-width":"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"账号状态","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:"enabled"===e.row.state?"primary":"danger","close-transition":""}},[t._v(t._s(t.state(e)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作","header-align":"center",align:"center",width:"320",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.common.permissions("/account/resetPassword")?a("el-button",{attrs:{type:"warning",size:"small"},nativeOn:{click:function(a){a.preventDefault(),t.resetPass(e)}}},[t._v("\n              重置密码\n            ")]):t._e(),t._v(" "),t.common.permissions("PUT@/account/authorization")?a("el-button",{attrs:{type:"success",size:"small"},nativeOn:{click:function(a){a.preventDefault(),t.findAccountRoles(e)}}},[t._v("\n              分配角色\n            ")]):t._e(),t._v(" "),t.common.permissions("/account/[0-9]{0,9}")?a("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(a){a.preventDefault(),t.edit(e)}}},[t._v("\n              编辑\n            ")]):t._e(),t._v(" "),t.common.permissions("DELETE@/account/[0-9]{0,9}")?a("el-button",{attrs:{type:"danger",size:"small"},nativeOn:{click:function(a){a.preventDefault(),t.deleteRow(e)}}},[t._v("\n              删除\n            ")]):t._e()]}}])})],1)],1),t._v(" "),a("div",{staticClass:"block",staticStyle:{"text-align":"center",border:"1px solid #e4e4e4",background:"#eef1f6"}},[a("el-pagination",{attrs:{"page-sizes":[10,20,30,40,50,100,200],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.account.total},on:{"size-change":t.sizeChange,"current-change":t.currentChange}})],1)]),t._v(" "),a("el-dialog",{attrs:{title:"新增账号",visible:t.dialogAdd,width:"600px"},on:{"update:visible":function(e){t.dialogAdd=e}}},[a("el-form",{ref:"ruleFormAdd",attrs:{model:t.Info,rules:t.rules}},[a("el-form-item",{attrs:{label:"账号","label-width":t.formLabelWidth,prop:"username"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入账号",name:"username",size:"small","suffix-icon":"el-icon-edit-outline","auto-complete":"off"},model:{value:t.Info.username,callback:function(e){t.$set(t.Info,"username",e)},expression:"Info.username"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"姓名","label-width":t.formLabelWidth,prop:"hospitalStation[name]"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入姓名",name:"name",size:"small","suffix-icon":"el-icon-edit-outline","auto-complete":"off"},model:{value:t.Info.hospitalStation.name,callback:function(e){t.$set(t.Info.hospitalStation,"name",e)},expression:"Info.hospitalStation.name"}})],1),t._v(" "),t.isSuperAdmin?a("el-form-item",{attrs:{label:"所属医院","label-width":t.formLabelWidth,prop:"hospitalStation[hospitalId]"}},[a("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"请选择所属医院",size:"small",name:"hospitalName",clearable:"",filterable:""},model:{value:t.Info.hospitalStation.hospitalId,callback:function(e){t.$set(t.Info.hospitalStation,"hospitalId",e)},expression:"Info.hospitalStation.hospitalId"}},t._l(t.hospitalList,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"科室","label-width":t.formLabelWidth}},[a("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"请选择科室",size:"small",name:"departmentName",clearable:"",filterable:""},model:{value:t.Info.hospitalStation.departmentId,callback:function(e){t.$set(t.Info.hospitalStation,"departmentId",e)},expression:"Info.hospitalStation.departmentId"}},t._l(t.departmentList,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){e.preventDefault(),t.dialogAdd=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.addSave(e)}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"分配角色",visible:t.dialogVisible,width:"600px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-checkbox-group",{model:{value:t.ids,callback:function(e){t.ids=e},expression:"ids"}},t._l(t.roles.roles,function(e,i){return a("el-checkbox",{key:i,staticStyle:{width:"20%"},attrs:{label:e.id}},[t._v(t._s(e.name))])})),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){e.preventDefault(),t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){e.preventDefault(),t.EditRole()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"编辑账号",visible:t.dialogEdit,width:"600px"},on:{"update:visible":function(e){t.dialogEdit=e}}},[a("el-form",{ref:"ruleFormEdit",attrs:{model:t.Info,rules:t.rules}},[a("el-form-item",{attrs:{label:"账号","label-width":t.formLabelWidth,prop:"username"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入账号",name:"username",size:"small","suffix-icon":"el-icon-edit-outline","auto-complete":"off",disabled:!0},model:{value:t.Info.username,callback:function(e){t.$set(t.Info,"username",e)},expression:"Info.username"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"姓名","label-width":t.formLabelWidth,prop:"hospitalStation[name]"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入姓名",name:"name",size:"small","suffix-icon":"el-icon-edit-outline","auto-complete":"off"},model:{value:t.Info.hospitalStation.name,callback:function(e){t.$set(t.Info.hospitalStation,"name",e)},expression:"Info.hospitalStation.name"}})],1),t._v(" "),a("el-form-item",{staticStyle:{display:"none"},attrs:{label:"id","label-width":t.formLabelWidth}},[a("el-input",{staticStyle:{width:"250px"},attrs:{name:"id",size:"small","suffix-icon":"el-icon-edit-outline","auto-complete":"off"},model:{value:t.Info.id,callback:function(e){t.$set(t.Info,"id",e)},expression:"Info.id"}})],1),t._v(" "),t.isSuperAdmin?a("el-form-item",{attrs:{label:"所属医院","label-width":t.formLabelWidth,prop:"hospitalStation[hospitalId]"}},[a("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"请选择所属医院",size:"small",clearable:"",filterable:""},model:{value:t.Info.hospitalStation.hospitalId,callback:function(e){t.$set(t.Info.hospitalStation,"hospitalId",t._n(e))},expression:"Info.hospitalStation.hospitalId"}},t._l(t.hospitalList,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"科室","label-width":t.formLabelWidth}},[a("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"请选择科室",size:"small",clearable:"",filterable:""},model:{value:t.Info.hospitalStation.departmentId,callback:function(e){t.$set(t.Info.hospitalStation,"departmentId",e)},expression:"Info.hospitalStation.departmentId"}},t._l(t.departmentList,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"状态","label-width":t.formLabelWidth}},[a("el-radio-group",{model:{value:t.Info.state,callback:function(e){t.$set(t.Info,"state",e)},expression:"Info.state"}},[a("el-radio",{attrs:{label:"enabled"}},[t._v("启用")]),t._v(" "),a("el-radio",{attrs:{label:"disabled"}},[t._v("禁用")])],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){e.preventDefault(),t.dialogEdit=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.editSave(e)}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var m=a("VU/8")(d,p,!1,function(t){a("FuKY")},"data-v-3b0240d7",null);e.default=m.exports}});